<!DOCTYPE html>
<!-- saved from url=(0061)file:///E:/Cursor/LogHelper2/LogHelper/src/doc/loghelper.html -->
<html lang="zh-CN"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LogHelper 系统架构</title>
    <style>
        body {
            font-family: 'Microsoft YaHei', '微软雅黑', 'PingFang SC', sans-serif;
            line-height: 1.6;
            color: #333;
            margin: 0;
            padding: 20px;
            background-color: #f7f9fc;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #fff;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-radius: 8px;
        }
        header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        h2 {
            color: #3498db;
            margin-top: 40px;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        h3 {
            color: #2980b9;
            margin-top: 30px;
        }
        .intro {
            background-color: #e8f4fc;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
        }
        .architecture-diagram {
            background-color: #f9f9f9;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            margin: 20px 0;
            overflow: auto;
        }
        .component {
            border: 2px solid #3498db;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            background-color: #f8f9fa;
        }
        .component-title {
            background-color: #3498db;
            color: white;
            padding: 8px 15px;
            margin: -15px -15px 15px -15px;
            border-radius: 6px 6px 0 0;
            font-weight: bold;
        }
        .code-block {
            background-color: #282c34;
            color: #abb2bf;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-family: 'Courier New', Courier, monospace;
            margin: 15px 0;
        }
        .comment { color: #98c379; }
        .keyword { color: #c678dd; }
        .string { color: #e5c07b; }
        .function { color: #61afef; }
        .chart {
            width: 100%;
            max-width: 800px;
            margin: 30px auto;
        }
        .flow-diagram {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 30px 0;
        }
        .flow-box {
            border: 2px solid #3498db;
            border-radius: 8px;
            padding: 10px 20px;
            margin: 10px;
            min-width: 200px;
            text-align: center;
            background-color: #edf7fd;
        }
        .flow-arrow {
            font-size: 24px;
            color: #3498db;
            margin: 5px 0;
        }
        .module-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        .table-container {
            overflow-x: auto;
            margin: 20px 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #3498db;
            color: white;
        }
        tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        .footer {
            text-align: center;
            margin-top: 50px;
            padding-top: 20px;
            border-top: 1px solid #eaeaea;
            color: #7f8c8d;
        }
        
        /* 添加loghelper-architecture-diagrams.html中的样式 */
        .architecture-box {
            fill: #ffffff;
            stroke: #1890ff;
            stroke-width: 2;
            rx: 8;
            ry: 8;
        }
        .architecture-text {
            font-family: 'Microsoft YaHei', '微软雅黑', 'PingFang SC', sans-serif;
            font-size: 14px;
            font-weight: 500;
            fill: #2c3e50;
            text-anchor: middle;
            dominant-baseline: middle;
        }
        .architecture-arrow {
            stroke: #1890ff;
            stroke-width: 2;
            fill: none;
            marker-end: url(#arrowhead);
        }
        .box-top-level {
            fill: #e6f7ff;
        }
        .box-facade {
            fill: #bae7ff;
        }
        .box-core {
            fill: #91d5ff;
        }
        .box-base {
            fill: #69c0ff;
        }
        .box-implementation {
            fill: #40a9ff;
        }
        .box-implementation text {
            fill: #ffffff;
        }
        .box-helper {
            fill: #1890ff;
        }
        .box-helper text {
            fill: #ffffff;
        }
        
        /* 生命周期图样式 */
        .lifecycle-box {
            fill: #ffffff;
            stroke: #1890ff;
            stroke-width: 2;
            rx: 8;
            ry: 8;
        }
        .lifecycle-text {
            font-family: 'Microsoft YaHei', '微软雅黑', 'PingFang SC', sans-serif;
            font-size: 14px;
            font-weight: 500;
            fill: #2c3e50;
            text-anchor: middle;
            dominant-baseline: middle;
        }
        .lifecycle-arrow {
            stroke: #1890ff;
            stroke-width: 2;
            fill: none;
            marker-end: url(#arrowhead);
        }
        .lifecycle-action {
            font-family: 'Microsoft YaHei', '微软雅黑', 'PingFang SC', sans-serif;
            font-size: 12px;
            fill: #1890ff;
            text-anchor: middle;
        }
        .state-uninit {
            fill: #e6f7ff;
        }
        .state-init {
            fill: #bae7ff;
        }
        .state-processing {
            fill: #91d5ff;
        }
        .state-output {
            fill: #69c0ff;
        }
        .state-shutdown {
            fill: #40a9ff;
        }
        .state-shutdown text {
            fill: #ffffff;
        }
        .state-closed {
            fill: #1890ff;
        }
        .state-closed text {
            fill: #ffffff;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>LogHelper 日志系统架构</h1>
            <p>轻量级、高性能的.NET日志记录框架</p>
        </header>

        <div class="intro">
            <h2>简介</h2>
            <p>LogHelper是一个轻量级、高性能的.NET日志记录框架，专为.NET应用程序设计。它提供了简单易用的API，支持多种日志输出目标（文件、控制台、内存），可配置的日志级别，以及高效的文件轮转和压缩功能。</p>
            <p>该系统设计注重简洁性和性能，采用了模块化和可扩展的架构，确保在保持代码可维护性的同时提供高效的日志记录能力。</p>
        </div>

        <h2>系统架构概览</h2>
        <p>LogHelper系统采用了分层设计和组件化架构，主要由以下几个核心部分组成：</p>

        <div class="module-grid">
            <div class="component">
                <div class="component-title">LogHelper</div>
                <p>静态门面类，提供简化的API接口，作为用户代码与日志系统的主要接口点。</p>
                <p>负责系统初始化、配置和日志记录方法的暴露。</p>
            </div>
            <div class="component">
                <div class="component-title">Log核心</div>
                <p>核心日志处理引擎，负责日志消息的处理和分发。</p>
                <p>管理日志接收器列表，并根据日志级别将消息转发到相应接收器。</p>
            </div>
            <div class="component">
                <div class="component-title">LogSink</div>
                <p>抽象的日志接收器基类，定义了所有日志接收器的共同行为。</p>
                <p>提供了日志过滤和写入的基础实现。</p>
            </div>
            <div class="component">
                <div class="component-title">具体日志接收器</div>
                <p>包括文件日志接收器(FileLogSink)、控制台日志接收器(ConsoleLogSink)和内存日志接收器(MemoryLogSink)。</p>
                <p>每个接收器负责将日志写入到特定目标。</p>
            </div>
        </div>

        <h2>组件结构</h2>

        <h3>1. 核心组件图</h3>
        <div class="architecture-diagram">
            <svg width="700" height="500" xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
                        <polygon points="0 0, 10 3.5, 0 7" fill="#1890ff"></polygon>
                    </marker>
                </defs>
                
                <!-- 用户应用程序 -->
                <rect x="250" y="20" width="200" height="50" class="architecture-box box-top-level"></rect>
                <text x="350" y="45" class="architecture-text">用户应用程序</text>
                
                <!-- LogHelper -->
                <rect x="250" y="120" width="200" height="50" class="architecture-box box-facade"></rect>
                <text x="350" y="145" class="architecture-text">LogHelper</text>
                
                <!-- Log核心 -->
                <rect x="250" y="220" width="200" height="50" class="architecture-box box-core"></rect>
                <text x="350" y="245" class="architecture-text">Log核心</text>
                
                <!-- LogSink基类 -->
                <rect x="250" y="320" width="200" height="50" class="architecture-box box-base"></rect>
                <text x="350" y="345" class="architecture-text">LogSink基类</text>
                
                <!-- 具体接收器 -->
                <rect x="100" y="420" width="120" height="50" class="architecture-box box-implementation"></rect>
                <text x="160" y="445" class="architecture-text">文件日志接收器</text>
                
                <rect x="290" y="420" width="120" height="50" class="architecture-box box-implementation"></rect>
                <text x="350" y="445" class="architecture-text">控制台日志接收器</text>
                
                <rect x="480" y="420" width="120" height="50" class="architecture-box box-implementation"></rect>
                <text x="540" y="445" class="architecture-text">内存日志接收器</text>
                
                <!-- 连接线 -->
                <line x1="350" y1="70" x2="350" y2="100" class="architecture-arrow"></line>
                <line x1="350" y1="170" x2="350" y2="200" class="architecture-arrow"></line>
                <line x1="350" y1="270" x2="350" y2="300" class="architecture-arrow"></line>
                <line x1="270" y1="370" x2="160" y2="410" class="architecture-arrow"></line>
                <line x1="350" y1="370" x2="350" y2="400" class="architecture-arrow"></line>
                <line x1="430" y1="370" x2="540" y2="410" class="architecture-arrow"></line>
            </svg>
        </div>

        <h3>2. 数据流程图</h3>
        <div class="architecture-diagram">
            <svg width="700" height="600" xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <marker id="arrowhead2" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
                        <polygon points="0 0, 10 3.5, 0 7" fill="#1890ff"></polygon>
                    </marker>
                </defs>
                
                <!-- 用户应用程序 -->
                <rect x="50" y="50" width="150" height="80" class="architecture-box box-top-level"></rect>
                <text x="125" y="90" class="architecture-text">用户应用程序</text>
                
                <!-- LogHelper -->
                <rect x="400" y="50" width="150" height="80" class="architecture-box box-facade"></rect>
                <text x="475" y="90" class="architecture-text">LogHelper</text>
                
                <!-- 日志消息流箭头 -->
                <line x1="200" y1="90" x2="380" y2="90" class="architecture-arrow" style="marker-end: url(#arrowhead2);"></line>
                <text x="300" y="70" class="architecture-text" style="font-size: 12px;">LogMessage</text>
                
                <!-- Log核心 -->
                <rect x="275" y="200" width="200" height="80" class="architecture-box box-core"></rect>
                <text x="375" y="240" class="architecture-text">Log核心</text>
                
                <!-- LogHelper到Log箭头 -->
                <line x1="475" y1="130" x2="375" y2="185" class="architecture-arrow" style="marker-end: url(#arrowhead2);"></line>
                <text x="435" y="175" class="architecture-text" style="font-size: 12px;">LogMessage</text>
                
                <!-- 日志接收器 -->
                <rect x="50" y="350" width="150" height="80" class="architecture-box box-implementation"></rect>
                <text x="125" y="390" class="architecture-text">FileLogSink</text>
                
                <rect x="275" y="350" width="150" height="80" class="architecture-box box-implementation"></rect>
                <text x="350" y="390" class="architecture-text">ConsoleLogSink</text>
                
                <rect x="500" y="350" width="150" height="80" class="architecture-box box-implementation"></rect>
                <text x="575" y="390" class="architecture-text">MemoryLogSink</text>
                
                <!-- Log核心到接收器的箭头 -->
                <line x1="275" y1="280" x2="125" y2="340" class="architecture-arrow" style="marker-end: url(#arrowhead2);"></line>
                <line x1="375" y1="280" x2="350" y2="330" class="architecture-arrow" style="marker-end: url(#arrowhead2);"></line>
                <line x1="475" y1="280" x2="575" y2="340" class="architecture-arrow" style="marker-end: url(#arrowhead2);"></line>
                <text x="210" y="320" class="architecture-text" style="font-size: 12px;">LogMessage</text>
                <text x="360" y="320" class="architecture-text" style="font-size: 12px;">LogMessage</text>
                <text x="510" y="320" class="architecture-text" style="font-size: 12px;">LogMessage</text>
                
                <!-- 文件日志输出 -->
                <rect x="50" y="500" width="150" height="60" class="architecture-box"></rect>
                <text x="125" y="530" class="architecture-text">日志文件(.log/.gz)</text>
                
                <line x1="125" y1="430" x2="125" y2="480" class="architecture-arrow" style="marker-end: url(#arrowhead2);"></line>
                <text x="180" y="460" class="architecture-text" style="font-size: 12px;">格式化日志</text>
            </svg>
        </div>

        <h3>3. 组件类图</h3>
        <div class="architecture-diagram">
            <svg width="800" height="650" xmlns="http://www.w3.org/2000/svg">
                <!-- ILogSink接口 -->
                <rect x="100" y="50" width="180" height="100" class="architecture-box"></rect>
                <text x="190" y="80" class="architecture-text" style="font-weight: bold;">ILogSink</text>
                <line x1="120" y1="90" x2="260" y2="90" stroke="#1890ff" stroke-width="1"></line>
                <text x="190" y="120" class="architecture-text" style="font-size: 12px;">+ EnabledCategories: LogCategory</text>
                <text x="190" y="140" class="architecture-text" style="font-size: 12px;">+ Write(LogMessage): bool</text>
                
                <!-- LogSink基类 -->
                <rect x="350" y="50" width="180" height="120" class="architecture-box"></rect>
                <text x="440" y="80" class="architecture-text" style="font-weight: bold;">LogSink</text>
                <line x1="370" y1="90" x2="510" y2="90" stroke="#1890ff" stroke-width="1"></line>
                <text x="440" y="120" class="architecture-text" style="font-size: 12px;">+ EnabledCategories: LogCategory</text>
                <text x="440" y="140" class="architecture-text" style="font-size: 12px;">+ Write(LogMessage): bool</text>
                <text x="440" y="160" class="architecture-text" style="font-size: 12px;"># DoWrite(LogMessage): bool</text>
                
                <!-- 实现箭头 -->
                <line x1="280" y1="100" x2="350" y2="100" class="architecture-arrow" style="marker-end: url(#arrowhead2);"></line>
                <text x="315" y="90" class="architecture-text" style="font-size: 12px;">实现</text>
                
                <!-- FileLogSink -->
                <rect x="80" y="250" width="220" height="180" class="architecture-box"></rect>
                <text x="190" y="280" class="architecture-text" style="font-weight: bold;">FileLogSink</text>
                <line x1="100" y1="290" x2="280" y2="290" stroke="#1890ff" stroke-width="1"></line>
                <text x="190" y="310" class="architecture-text" style="font-size: 12px;">+ BaseDirectory: string</text>
                <text x="190" y="330" class="architecture-text" style="font-size: 12px;">+ DateSubDirectory: string</text>
                <text x="190" y="350" class="architecture-text" style="font-size: 12px;">+ MaxFileSize: long</text>
                <text x="190" y="370" class="architecture-text" style="font-size: 12px;">+ MaxDaysOld: int</text>
                <text x="190" y="390" class="architecture-text" style="font-size: 12px;">+ EnableCompression: bool</text>
                <text x="190" y="410" class="architecture-text" style="font-size: 12px;"># DoWrite(LogMessage): bool</text>
                
                <!-- ConsoleLogSink -->
                <rect x="335" y="250" width="180" height="100" class="architecture-box"></rect>
                <text x="425" y="280" class="architecture-text" style="font-weight: bold;">ConsoleLogSink</text>
                <line x1="355" y1="290" x2="495" y2="290" stroke="#1890ff" stroke-width="1"></line>
                <text x="425" y="320" class="architecture-text" style="font-size: 12px;"># DoWrite(LogMessage): bool</text>
                <text x="425" y="340" class="architecture-text" style="font-size: 12px;">- WriteColored(string, ConsoleColor)</text>
                
                <!-- MemoryLogSink -->
                <rect x="550" y="250" width="180" height="120" class="architecture-box"></rect>
                <text x="640" y="280" class="architecture-text" style="font-weight: bold;">MemoryLogSink</text>
                <line x1="570" y1="290" x2="710" y2="290" stroke="#1890ff" stroke-width="1"></line>
                <text x="640" y="320" class="architecture-text" style="font-size: 12px;">+ MaxMessages: int</text>
                <text x="640" y="340" class="architecture-text" style="font-size: 12px;">+ GetMessages(): LogMessage[]</text>
                <text x="640" y="360" class="architecture-text" style="font-size: 12px;"># DoWrite(LogMessage): bool</text>
                
                <!-- 继承箭头 -->
                <line x1="190" y1="200" x2="190" y2="250" class="architecture-arrow" style="marker-end: url(#arrowhead2);"></line>
                <line x1="440" y1="170" x2="440" y2="250" class="architecture-arrow" style="marker-end: url(#arrowhead2);"></line>
                <line x1="455" y1="170" x2="640" y2="250" class="architecture-arrow" style="marker-end: url(#arrowhead2);"></line>
                
                <!-- LogMessage -->
                <rect x="350" y="450" width="200" height="150" class="architecture-box"></rect>
                <text x="450" y="480" class="architecture-text" style="font-weight: bold;">LogMessage</text>
                <line x1="370" y1="490" x2="530" y2="490" stroke="#1890ff" stroke-width="1"></line>
                <text x="450" y="510" class="architecture-text" style="font-size: 12px;">+ UtcTimestamp: long</text>
                <text x="450" y="530" class="architecture-text" style="font-size: 12px;">+ Source: string</text>
                <text x="450" y="550" class="architecture-text" style="font-size: 12px;">+ Type: string</text>
                <text x="450" y="570" class="architecture-text" style="font-size: 12px;">+ Category: LogCategory</text>
                <text x="450" y="590" class="architecture-text" style="font-size: 12px;">+ Message: string</text>
            </svg>
        </div>

        <h3>4. API使用时序图</h3>
        <p>下面的时序图展示了LogHelper系统的关键操作流程和组件交互：</p>

        <div class="architecture-diagram">
            <svg width="950" height="600" xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <marker id="arrowhead4" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                        <polygon points="0 0, 10 3.5, 0 7" fill="#1890ff"></polygon>
                    </marker>
                </defs>
                
                <!-- 背景红框 -->
                <rect x="20" y="90" width="900" height="500" fill="transparent" stroke="#ff4d4f" stroke-width="1"></rect>
                
                <!-- 水平五条生命线 -->
                <line x1="110" y1="80" x2="110" y2="550" stroke="#ddd" stroke-width="2" stroke-dasharray="5,5"></line>
                <line x1="270" y1="80" x2="270" y2="550" stroke="#ddd" stroke-width="2" stroke-dasharray="5,5"></line>
                <line x1="430" y1="80" x2="430" y2="550" stroke="#ddd" stroke-width="2" stroke-dasharray="5,5"></line>
                <line x1="590" y1="80" x2="590" y2="550" stroke="#ddd" stroke-width="2" stroke-dasharray="5,5"></line>
                <line x1="750" y1="80" x2="750" y2="550" stroke="#ddd" stroke-width="2" stroke-dasharray="5,5"></line>
                
                <!-- 参与者框 -->
                <rect x="50" y="30" width="120" height="50" rx="5" ry="5" fill="#e6f7ff" stroke="#1890ff" stroke-width="2"></rect>
                <text x="110" y="60" text-anchor="middle" font-family="&#39;Microsoft YaHei&#39;" font-size="14px" fill="#333">应用程序</text>
                
                <rect x="210" y="30" width="120" height="50" rx="5" ry="5" fill="#bae7ff" stroke="#1890ff" stroke-width="2"></rect>
                <text x="270" y="60" text-anchor="middle" font-family="&#39;Microsoft YaHei&#39;" font-size="14px" fill="#333">LogHelper</text>
                
                <rect x="370" y="30" width="120" height="50" rx="5" ry="5" fill="#91d5ff" stroke="#1890ff" stroke-width="2"></rect>
                <text x="430" y="60" text-anchor="middle" font-family="&#39;Microsoft YaHei&#39;" font-size="14px" fill="#333">Log核心</text>
                
                <rect x="530" y="30" width="120" height="50" rx="5" ry="5" fill="#69c0ff" stroke="#1890ff" stroke-width="2"></rect>
                <text x="590" y="60" text-anchor="middle" font-family="&#39;Microsoft YaHei&#39;" font-size="14px" fill="#333">日志接收器集合</text>
                
                <rect x="690" y="30" width="120" height="50" rx="5" ry="5" fill="#40a9ff" stroke="#1890ff" stroke-width="2"></rect>
                <text x="750" y="60" text-anchor="middle" font-family="&#39;Microsoft YaHei&#39;" font-size="14px" fill="#333">具体日志接收器</text>
                
                <!-- 初始化流程 - 水平箭头 -->
                <line x1="110" y1="120" x2="270" y2="120" stroke="#1890ff" stroke-width="1.5" marker-end="url(#arrowhead4)"></line>
                <text x="190" y="110" font-size="12px" fill="#1890ff" text-anchor="middle">1. Initialize()</text>
                
                <line x1="270" y1="160" x2="430" y2="160" stroke="#1890ff" stroke-width="1.5" marker-end="url(#arrowhead4)"></line>
                <text x="350" y="150" font-size="12px" fill="#1890ff" text-anchor="middle">2. 创建日志接收器</text>
                
                <line x1="430" y1="200" x2="590" y2="200" stroke="#1890ff" stroke-width="1.5" marker-end="url(#arrowhead4)"></line>
                <text x="510" y="190" font-size="12px" fill="#1890ff" text-anchor="middle">3. Add(sink)</text>
                
                <line x1="590" y1="240" x2="750" y2="240" stroke="#1890ff" stroke-width="1.5" marker-end="url(#arrowhead4)"></line>
                <text x="670" y="230" font-size="12px" fill="#1890ff" text-anchor="middle">4. 添加到集合</text>
                
                <!-- 日志记录流程 - 水平箭头 -->
                <line x1="110" y1="300" x2="270" y2="300" stroke="#1890ff" stroke-width="1.5" marker-end="url(#arrowhead4)"></line>
                <text x="190" y="290" font-size="12px" fill="#1890ff" text-anchor="middle">5. Info/Debug/...</text>
                
                <line x1="270" y1="340" x2="430" y2="340" stroke="#1890ff" stroke-width="1.5" marker-end="url(#arrowhead4)"></line>
                <text x="350" y="330" font-size="12px" fill="#1890ff" text-anchor="middle">6. WriteIfEnabled</text>
                
                <line x1="430" y1="370" x2="590" y2="370" stroke="#1890ff" stroke-width="1.5" marker-end="url(#arrowhead4)"></line>
                <text x="510" y="360" font-size="12px" fill="#1890ff" text-anchor="middle">7. 检查日志级别</text>
                
                <!-- 步骤8应在同一垂直线上 -->
                <line x1="430" y1="390" x2="480" y2="390" stroke="#1890ff" stroke-width="1.5" marker-end="url(#arrowhead4)"></line>
                <text x="455" y="380" font-size="12px" fill="#1890ff">8. 创建LogMessage</text>
                
                <line x1="430" y1="410" x2="590" y2="410" stroke="#1890ff" stroke-width="1.5" marker-end="url(#arrowhead4)"></line>
                <text x="510" y="400" font-size="12px" fill="#1890ff" text-anchor="middle">9. 获取所有接收器</text>
                
                <line x1="590" y1="430" x2="430" y2="430" stroke="#1890ff" stroke-width="1.5" marker-end="url(#arrowhead4)"></line>
                <text x="510" y="420" font-size="12px" fill="#1890ff" text-anchor="middle">10. 返回接收器集合</text>
                
                <line x1="430" y1="460" x2="750" y2="460" stroke="#1890ff" stroke-width="1.5" marker-end="url(#arrowhead4)"></line>
                <text x="590" y="450" font-size="12px" fill="#1890ff" text-anchor="middle">11. Write(msg)</text>
                
                <!-- 两个自我调用步骤 -->
                <line x1="750" y1="480" x2="780" y2="480" stroke="#1890ff" stroke-width="1.5" marker-end="url(#arrowhead4)"></line>
                <text x="765" y="470" font-size="12px" fill="#1890ff">12. DoWrite(msg)</text>
                <text x="765" y="500" font-size="12px" fill="#1890ff">13. 实际写入操作</text>
                
                <!-- 返回流程 - 水平箭头 -->
                <line x1="270" y1="500" x2="110" y2="500" stroke="#1890ff" stroke-width="1.5" marker-end="url(#arrowhead4)"></line>
                <text x="190" y="480" font-size="12px" fill="#1890ff" text-anchor="middle">14. 返回</text>
                
                <!-- 关闭流程 - 水平箭头 -->
                <line x1="110" y1="540" x2="270" y2="540" stroke="#1890ff" stroke-width="1.5" marker-end="url(#arrowhead4)"></line>
                <text x="190" y="530" font-size="12px" fill="#1890ff" text-anchor="middle">15. Shutdown()</text>
                
                <line x1="270" y1="560" x2="430" y2="560" stroke="#1890ff" stroke-width="1.5" marker-end="url(#arrowhead4)"></line>
                <text x="350" y="550" font-size="12px" fill="#1890ff" text-anchor="middle">16. Shutdown()</text>
            </svg>
        </div>

        <p>API使用时序图展示了系统的三个主要流程：</p>
        <ol>
            <li><strong>初始化流程（步骤1-4）</strong>：应用程序调用LogHelper.Initialize()，创建并配置日志接收器。</li>
            <li><strong>日志记录流程（步骤5-14）</strong>：应用程序调用日志记录方法，LogHelper核心处理日志级别过滤，并将消息分发到相应接收器。</li>
            <li><strong>关闭流程（步骤15-16）</strong>：应用程序调用LogHelper.Shutdown()，系统执行资源清理和释放操作。</li>
        </ol>

        <h2>关键特性</h2>
        
        <div class="module-grid">
            <div class="component">
                <div class="component-title">易用性</div>
                <p>提供简单直观的API，通过静态方法调用即可完成日志记录。</p>
                <p>支持不同级别的日志记录：Debug、Info、Warning、Error。</p>
            </div>
            <div class="component">
                <div class="component-title">可扩展性</div>
                <p>基于接口和抽象类设计，易于扩展新的日志接收器。</p>
                <p>支持多种输出目标，包括文件、控制台和内存。</p>
            </div>
            <div class="component">
                <div class="component-title">高性能</div>
                <p>优化的文件IO操作，支持异步日志写入。</p>
                <p>高效的日志消息格式化和序列化。</p>
                <p>简化的数据结构，避免过度设计和抽象。</p>
            </div>
            <div class="component">
                <div class="component-title">文件管理</div>
                <p>支持日志文件轮转，限制单文件大小。</p>
                <p>支持日志文件保留策略，自动清理旧文件。</p>
                <p>支持日志文件压缩，节省存储空间。</p>
            </div>
        </div>

        <h2>使用示例</h2>
        
        <h3>初始化日志系统</h3>
        <div class="code-block">
            <pre><span class="comment">// 使用默认设置初始化</span>
<span class="function">LogHelper.Initialize</span>(<span class="string">"MyApplication"</span>);
            
<span class="comment">// 使用自定义设置初始化</span>
<span class="function">LogHelper.Initialize</span>(
    applicationName: <span class="string">"MyApplication"</span>,  <span class="comment">// 应用程序名称</span>
    logDirectory: <span class="string">"Logs"</span>,             <span class="comment">// 日志目录</span>
    enabledCategories: LogCategory.All, <span class="comment">// 启用所有日志级别</span>
    maxFileSize: 10 * 1024 * 1024,    <span class="comment">// 最大文件大小（10MB）</span>
    maxDaysOld: 30,                   <span class="comment">// 日志保留天数</span>
    logToConsole: true,               <span class="comment">// 同时输出到控制台</span>
    enableCompression: true           <span class="comment">// 启用日志文件压缩</span>
);</pre>
        </div>
        
        <h3>记录日志</h3>
        <div class="code-block">
            <pre><span class="comment">// 记录不同级别的日志</span>
<span class="function">LogHelper.Debug</span>(<span class="string">"Module1"</span>, <span class="string">"这是一条调试信息"</span>);
<span class="function">LogHelper.Info</span>(<span class="string">"Module1"</span>, <span class="string">"这是一条普通信息"</span>);
<span class="function">LogHelper.Warning</span>(<span class="string">"Module1"</span>, <span class="string">"这是一条警告信息"</span>);
<span class="function">LogHelper.Error</span>(<span class="string">"Module1"</span>, <span class="string">"这是一条错误信息"</span>);
            
<span class="comment">// 使用格式化字符串</span>
<span class="function">LogHelper.Info</span>(<span class="string">"Module1"</span>, <span class="string">"用户 {0} 登录成功，角色: {1}"</span>, userName, role);
            
<span class="comment">// 记录异常</span>
<span class="keyword">try</span> {
    <span class="comment">// 可能抛出异常的代码</span>
}
<span class="keyword">catch</span> (Exception ex) {
    <span class="function">LogHelper.Exception</span>(<span class="string">"Module1"</span>, ex, <span class="string">"操作失败"</span>);
}</pre>
        </div>
        
        <h3>使用内存日志</h3>
        <div class="code-block">
            <pre><span class="comment">// 添加内存日志接收器</span>
MemoryLogSink memorySink = <span class="function">LogHelper.AddMemoryLogger</span>(1000); <span class="comment">// 最多保存1000条消息</span>
            
<span class="comment">// 注册新消息事件处理程序</span>
memorySink.NewMessageAdded += (sender, message) =&gt; {
    <span class="comment">// 处理新添加的日志消息</span>
};
            
<span class="comment">// 获取内存中的所有日志</span>
LogMessage[] messages = memorySink.GetMessages();</pre>
        </div>
        
        <h3>关闭日志系统</h3>
        <div class="code-block">
            <pre><span class="comment">// 在应用程序退出前关闭日志系统</span>
<span class="function">LogHelper.Shutdown</span>();</pre>
        </div>

        
        

        <div class="footer">
            <p>LogHelper 日志系统 - 版权所有 © 2023</p>
        </div>
    </div>

</body></html>